---
runtime: shiny
output: html_document
---

```{r housekeeping, echo = FALSE, warning=F, message=F, results='asis'}
# tidy
library(tidyverse)
# spatial
library(rgeos)
library(rgdal)
library(sp)
# housekeeping
library(rmarkdown)
# Epi
library(survey)


##----------------------------------##
##            Read-In Data          ## 
##----------------------------------##
load("~/Documents/GitHub/VivID_PhD_Thesis/Preliminary_PowerCalc/RBC_Antigen_Prev/data.RData")

```


# Goal 
The purpose of this script is to determine the precision afforded by the different levels of sampling the **DHS DRC-II Adult Dataset**. I am going to focus on 

# Prior Distributions for Allele Frequencies
#### Duffy Genotypes
The prior distributions for Duffy-Genoytpes are based on the results from [Howe et al. 2011](https://www.nature.com/articles/ncomms1265). This is a Bayesian geostatistical model based on "821 spatially unique data points of Duffy blood type ... represented a total of 131,187 individuals sampled, 17.8% of whom were surveyed on the African continent (Table 1). Of this total, 536 surveys were geopositioned as points (â‰¤25 km2), and 285 mapped as polygon centroids." **None of the spatial data points are from the DRC based on Fig 2**. Still widely considered the best resource for Duffy-Genotypes and because this was Bayesian, the uncertainty is expressed nicely such that it works with the model I am building below well.   
In addition, the recent review by [Hoher et al. 2017](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5770319/) suggests that Duffy-ES is fixated across the continent. However, they do note there is some variation among Sudanese individuals, which may have migrated to the DRC in recent years...

#### Hemoglobinopathies 
Prior distributions for hemoglobinopathy genotypes are based on the result from [Tshilolo et al. 2009](https://www.ncbi.nlm.nih.gov/pubmed/19103857), [Piel et al. 2010](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3060623/), [Piel et al. 2013](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3628164/), and [Williams et al. 2012](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3426822/).

##### HbS
[Piel et al. 2010](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3060623/) is using data from [MalariaGEN](https://www.malariagen.net/) and a Bayesian statistical approach. Probably the best of these for HbS to use. 


##### HbC
Again [Piel et al. 2013](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3628164/) is using data from [MalariaGEN](https://www.malariagen.net/) and a Bayesian statistical approach. Probably the best of these for HbC to use. 

May be some HbC in Ituri, Haut-Uele, or North Kivu area... 

##### G6PD
Using [Howes et al. 2012](http://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.1001339). Same group and same Bayesian geostatistical model from above...

```{r datainput, echo = FALSE, warning=F, message=F, results='asis'}
# this is not how I like to do this... but given that I don't have a lot of information or can scrape easily, it is what is going to suffice. 

dt <- data.frame(genotype = c("FY*B-ES", "HbS", "HbC", "G6PD"),
           lowerbound = c(80, 8, 0, 1),
           upperbound = c(100, 20, 2.5, 40)
  )


```



## Sampling Selection
We identifed 579 cases by RT-PCR -- subject to change. 





```{r echo = FALSE, warning=F, message=F, results='asis'}
selectInput("n", label = "Number of bins:",
              choices = c(10, 20, 35, 50), selected = 20)
  
sliderInput("bw_adjust", label = "Bandwidth adjustment:",
              min = 0.2, max = 2, value = 1, step = 0.2)
```

### ...that build a histogram.

```{r echo = FALSE, warning=F, message=F, results='asis'}
renderPlot({
  hist(faithful$eruptions, probability = TRUE, 
       breaks = as.numeric(input$n_breaks),
       xlab = "Duration (minutes)", 
       main = "Geyser eruption duration")
  
  dens <- density(faithful$eruptions, adjust = input$bw_adjust)
  lines(dens, col = "blue")
})
```





